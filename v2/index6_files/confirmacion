function viewLoad(){actualizarEncabezado("<h4><strong>Confirmá<\/strong> tu información<\/h4><h1>Verificá que tus datos sean correctos.<\/h1>","#opcConfirmacionDatosAdicionales","headline small",!0);inputEfects();inputValidate();inputsEvents();lapizEvents();$("#btn-submit").click(function(){$("#FormFin").submit();$("#btn-submit").prop("onclick",null).off("click");stopDoubleSubmit("btn-submit")});$("#btn-Mail").click(function(){modificarCliente($("#Email").val(),"Mail")});$("#btn-Telefono").click(function(){var n=$("#CodArea").val(),t=$("#Telefono").val();n.substring(0,1)==="0"&&(n=n.substring(1));t.substring(0,2)==="15"&&(t=t.substring(2));modificarCliente(n.replace(" ","")+" "+t.replace(" ",""),"Telefono")});$("#btn-entrega").click(function(){altaPrepacto($("#fechaEntregaSel").val(),$("#fechaEntregaSel").data("special"))});$("#ButTermYCond").click(function(){$("#CheckTermYCond").prop("checked",!0).removeClass("incompleto");validarModificaciones()})}function lapizEvents(){$("#lapizTelefono").click(function(){lLenarInput("Telefono")});$("#lapizMail").click(function(){lLenarInput("Mail")});$("#lapizEntrega").click(function(){buscarTurnosAjax()})}function deshabilitarBoton(){$("#btn-submit").attr("class","btn btn-md disbaled margin-bottom-60");$("#btn-submit").prop("disabled",!0)}function modificarCliente(n,t){$.ajax({datatype:"json",type:"POST",url:"/Confirmacion/ModificarCliente",data:{valor:n,cambio:t},success:function(i){IsAjaxError(i)||(t==="Telefono"?$("#Info"+t).text($("#CodArea").val()+" "+$("#Telefono").val()):$("#Info"+t).text(n))},error:function(n){OnJsError(n,!1,"Error al modificar datos del cliente.");window.location.href="/error/InicioAjax"}})}function inputsEvents(){$("#Email").blur(function(){validateRegEx($(this).val(),regEx_mail)?($("#btn-Mail").prop("disabled",!1),$("#btn-Mail").attr("class","btn btn-xs")):($("#btn-Mail").prop("disabled",!0),$("#btn-Mail").attr("class","btn disabled btn-xs"))});$("#Telefono,#CodArea").blur(function(){var i=$("#CodArea").val(),r=$("#Telefono").val(),u=validateRegEx(r.replace(" ",""),regEx_numeros),f=validateRegEx(i.replace(" ",""),regEx_numeros),n,t;if(f&&u&&i!==""&&r!==""&&validarTelefono(r)&&validarCodArea(i)&&(n=i.replace(" ",""),t=r.replace(" ",""),n.substring(0,1)==="0"&&(n=n.substring(1)),t.substring(0,2)==="15"&&(t=t.substring(2)),t.length+n.length===10)){$("#btn-Telefono").prop("disabled",!1);$("#btn-Telefono").attr("class","btn btn-xs");return}$("#btn-Telefono").prop("disabled",!0);$("#btn-Telefono").attr("class","btn disabled btn-xs")})}function buscarTurnosAjax(){$.ajax({datatype:"json",type:"POST",url:"/Confirmacion/ObtenerTurnos",success:function(n){var t;if(IsAjaxError(n))prepactoImposible(),OnJsError(n,!1,"Error al buscar turnos disponibles para el prepacto.");else{$("#listaFechasEntrega").empty();t=n.turnos[0].FechaTurno.substring(n.turnos[0].FechaTurno.indexOf("(")+1,n.turnos[0].FechaTurno.indexOf(")"));t=new Date(parseInt(t));var i=t.getMonth()+1,r=t.getDate(),u=t.getFullYear(),f=t.getHours(),e=t.getMinutes(),o=t.getSeconds(),s=r+"/"+i+"/"+u+" "+f+":"+e+":"+o;$("#fechaEntregaSel").val(n.turnos[0].IdTurno);$("#fechaEntregaSel").data("special",s);var h=r+"/"+i,c=n.turnos[0].HoraDesde.split(":"),l=n.turnos[0].HoraHasta.split(":");$("#fechaEntrega").text(n.turnos[0].DiaTurno+" "+h+" de "+c[0]+" a "+l[0]+" hs");$.each(n.turnos,function(){t=this.FechaTurno.substring(this.FechaTurno.indexOf("(")+1,this.FechaTurno.indexOf(")"));t=new Date(parseInt(t));i=t.getMonth()+1;r=t.getDate();h=r+"/"+i;c=this.HoraDesde.split(":");l=this.HoraHasta.split(":");u=t.getFullYear();f=t.getHours();e=t.getMinutes();o=t.getSeconds();s=r+"/"+i+"/"+u+" "+f+":"+e+":"+o;$("#listaFechasEntrega").append($('<li><a href="javascript:void(0)" data-special="'+s+'" data-value="'+this.IdTurno+'">'+this.DiaTurno+" "+h+" de "+c[0]+" a "+l[0]+" hs<\/a><\/li>"))});$("#listaFechasEntrega").children().click(function(){agregarEventosSeleccionOpcionListaDesplegable($(this).children(),"fechaEntrega","fechaEntregaSel")});$("#modal-date").modal("show")}},error:function(n){prepactoImposible();OnJsError(n,!1,"Error al buscar turnos disponibles para el prepacto.")}})}function altaPrepacto(n,t){$.ajax({datatype:"json",type:"POST",url:"/Confirmacion/CrearPrepacto",data:{idTurno:n,fechaTurno:t},success:function(n){IsAjaxError(n)?(OnJsError(n,!1,"Error al modificar datos del cliente."),prepactoImposible()):($("#InfoFechaTurno").text(n.fechaTurno),$("#InfoHoraTurno").text(n.horaTurno))},error:function(n){prepactoImposible();OnJsError(n,!1,"Error al modificar datos del cliente.")}})}function lLenarInput(n){n==="Telefono"?($("#CodArea").val($("#InfoTelefono").text().substring(0,$("#InfoTelefono").text().indexOf(" "))).removeClass("incompleto").parent().removeClass("inputArea").addClass("inputArea typed"),$("#Telefono").val($("#InfoTelefono").text().substring($("#InfoTelefono").text().indexOf(" ")+1,$("#InfoTelefono").text().length).trim()).removeClass("incompleto").parent().removeClass("inputArea").addClass("inputArea typed"),$("#btn-Telefono").prop("disabled",!1),$("#btn-Telefono").attr("class","btn btn-xs")):($("#Email").val($("#InfoMail").text()).removeClass("incompleto").parent().removeClass("inputArea").addClass("inputArea typed"),$("#btn-Mail").prop("disabled",!1),$("#btn-Mail").attr("class","btn btn-xs"))}function validarModificaciones(){$(".incompleto").size()===0?($("#btn-submit").attr("class","btn btn-md margin-bottom-60"),$("#btn-submit").prop("disabled",!1)):($("#btn-submit").attr("class","btn btn-md disabled margin-bottom-60"),$("#btn-submit").prop("disabled",!0))}function prepactoImposible(){var n='<div class="row"><div class="col-xs-12"><p>Env&iacute;o<\/p><h5>Recibir&aacute;s la tarjeta en tu domicilio a partir de los '+cantDiasPrepac+" d&iacute;as h&aacute;biles.<\/h5><\/div><\/div>";$("#InfoEntrega").hide();$("#TituloEntrega").children().remove();$(n).insertAfter("#InfoEntrega")}var cantDiasPrepac,hayTurno