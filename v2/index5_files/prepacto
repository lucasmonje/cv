function viewLoad(){actualizarEncabezado("<h4><strong>Coordiná<\/strong> la entrega<\/h4><h5>Ya casi finalizás con el proceso de solicitud<\/h5><h1>Completá estos datos para definir los últimos detalles<\/h1>","#opcIngresoDatosAdicionales","headline medium",!0);inputValidateView();inputEfects();inputValidate();cargarEventosInputAdicionales();$("#SucursalProvincia").focus(function(){activeFour();$("#ListaSucursalLocalidadFull").css("display","none");$("#divListaSucursales").removeClass("open");$("#botonListaSucursales").attr("aria-expanded","false")});$("#SucursalLocalidad").focus(function(){activeFour();$("#divListaSucursales").removeClass("open");$("#botonListaSucursales").attr("aria-expanded","false")}).blur(function(){(provactual===""||provactual!==$("#cmbSucursalProvincia").val())&&(provactual=$("#cmbSucursalProvincia").val(),actualizarZoomProvincias(provactual))});$("#botonListaSucursales").on("click",function(){return $("#ListaSucursalLocalidadFull").css("display","none"),$("#listaSucursales").children("li").size()===0?!1:void 0});$("#SucursalRadicacionProducto").on("change",function(){actualizarSucursalCombo($("#SucursalRadicacionProducto").val())})}function setearValoresResidenciaTributaria(){$("#divInputAreaResidenciaTributaria").find("label").hide();$("#ResidenciaTributaria").keyup(function(){$(this).val()!==""?$("#divInputAreaResidenciaTributaria").find("label").hide():$("#divInputAreaResidenciaTributaria").find("label").show()});$("#cmbResidenciaTributaria").val($("#cmbResidenciaTributaria option:first").val());$("#ResidenciaTributaria").val($("#cmbResidenciaTributaria option:first").text());$("#ResidenciaTributaria").removeClass("incompleto")}function inputValidateView(){$("#modalAdicionalPaquete").on("show",function(){$("body").css("overflow","hidden");$("body").css("position","fixed")}).on("hidden",function(){$("body").css("overflow","");$("body").css("overflow","")}).bind("scroll",function(){$(".ui-autocomplete.ui-widget:visible").length>0&&(inputAutocomplete=$(":focus").prevObject.context.activeElement.id,$("#"+inputAutocomplete).autocomplete("close"))});crearCombosAutocompletables();setearValoresResidenciaTributaria();$("#cmbSucursalRadicacionProducto").val("");$("#listaSucursales").empty();$("#cmbSucursalLocalidad").val("");$("#cmbSucursalProvincia").val("");$("#cmbProvinciaTitular").val("");$("#cmbProvincia").val("");$("#PaisNacimientoTitular,#NacionalidadTitular,#EstadoCivilTitular,#ResidenciaTributaria,#ProvinciaTitular,#LocalidadTitular").focus(function(){activeOne()});$("#OtraDireccionprovincia,#Provincia,#Localidad").focus(function(){activeTwo()});$("html").bind("keypress",function(n){return!(n.keyCode===13)});$("#OtraDireccionCodigoPostal").bind("blur",function(){$(this).val()!==""&&validarCPDomicilioEntrega($("#cmbProvincia").val(),$("#cmbLocalidad").val(),$(this).val())});$("#CodigoPostal").bind("blur",function(){$(this).val()!==""&&validarCPDomicilioTitular($("#cmbProvinciaTitular").val(),$("#cmbLocalidadTitular").val(),$(this).val())});$("#btn-Continuar").click(function(){$("#ProvinciaTitular").val()!="Tierra Del Fuego"&&$("#cmbSucursalProvincia").val()==40?showErrorModal("Error","El domicilio ingresado no permite seleccionar sucursales en esta provincia"):($("#Form-DatosEntrega").submit(),$("#btn-Continuar").prop("onclick",null).off("click"),stopDoubleSubmit("btn-Continuar"))});$("#otraDireccion .incompleto").blur(function(){ValidarCodigoPostalOtroDomicilio=!1});$("#modalAdicionalPaquete").on("shown.bs.modal",function(){$("body").css("position","fixed").css("overflow","auto").css("height","100%");$("html").css("overflow","hidden").css("height","100%")}).on("hidden.bs.modal",function(){$("body").css("position","").css("overflow","").css("height","%");$("html").css("overflow","").css("height","")})}function crearCombosAutocompletables(){appendearulPaises();jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbPaisNacimientoTitular","divInputAreaPaisNacimientoTitular","PaisNacimientoTitular","País de nacimiento","50",2,"divPaisNacimientoTitular","PaisNacimientoTitularUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaPaisNacimientoTitularFull","alpha_spaces_enie incompleto","validarCamposPrimeraParte","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbNacionalidadTitular","divInputAreaNacionalidadTitular","NacionalidadTitular","Nacionalidad","50",2,"divNacionalidadTitular","NacionalidadTitularUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaNacionalidadTitularFull","alpha_spaces_enie incompleto","validarCamposPrimeraParte","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbProvinciaTitular","divInputAreaProvinciaTitular","ProvinciaTitular","Provincia","25",0,"divProvinciaTitular","ProvinciaTitularUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!0,"cmbLocalidadTitular","LocalidadTitular","","","alphanumeric_space_enie incompleto provincia","validarCamposPrimeraParte","LocalidadTitular","",!0,"limpiarCPTitular","new-password"));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbLocalidadTitular","divInputAreaLocalidadTitular","LocalidadTitular","Localidad","25",3,"divLocalidadTitular","LocalidadTitularUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaLocalidadTitularFull","localidad incompleto","validarCamposPrimeraParte","","",!0,"limpiarCPTitular","new-password"));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbEstadoCivilTitular","divInputAreaEstadoCivilTitular","EstadoCivilTitular","Estado Civil","25",0,"divEstadoCivilTitular","EstadoCivilTitularUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!1,"","alpha_spaces_enie incompleto","validarCamposPrimeraParte","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbResidenciaTributaria","divInputAreaResidenciaTributaria","ResidenciaTributaria","Residencia Tributaria","50",2,"divResidenciaTributaria","ResidenciaTributariaUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaResidenciaTributariaFull","alpha_spaces_enie","validarCamposPrimeraParte","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbProvincia","divInputAreaProvincia","Provincia","Provincia","25",0,"divProvincia","ProvinciaUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!0,"cmbLocalidad","Localidad","","","alphanumeric_space_enie provincia","validarCamposSegundaParte","Localidad","",!0,"limpiarCPOtraDireccion","new-password"));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbLocalidad","divInputAreaLocalidad","Localidad","Localidad","25",3,"divLocalidad","LocalidadUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaLocalidadFull","localidad","validarCamposSegundaParte",!0,"limpiarCPOtraDireccion","new-password"));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbSucursalProvincia","divInputAreaSucProvincia","SucursalProvincia","Provincia","25",0,"divSucursalProvincia","SucursalProvinciaUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!0,"cmbSucursalLocalidad","SucursalLocalidad","","","alphanumeric_space_enie provincia","","SucursalLocalidad","true",!1,"","new-password"));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbSucursalLocalidad","divInputAreaSucLocalidad","SucursalLocalidad","Localidad/Barrio","25",3,"divSucursalLocalidad","SucursalLocalidad","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaSucursalLocalidadFull","localidad","","","","",!1,"","new-password"));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbPaisNacimientoAdicional","divInputAreaPaisNacimientoAdicional","PaisNacimientoAdicional","País de nacimiento","25",2,"divPaisNacimientoAdicional","PaisNacimientoAdicionalUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaPaisNacimientoAdicionalFull","alpha_spaces_enie incompleto adicional","validarCamposAdicional","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbNacionalidadAdicional","divInputAreaNacionalidadAdicional","NacionalidadAdicional","Nacionalidad","25",2,"divNacionalidadAdicional","NacionalidadAdicionalUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!0,"ListaNacionalidadAdicionalFull","alpha_spaces_enie incompleto adicional","validarCamposAdicional","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbDia","divInputAreaDia","Dia","Dia","2",0,"divDia","DiaUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","","","","numbers adicional incompleto","validarCamposAdicional","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbMes","divInputAreaMes","Mes","Mes","10",0,"divMes","MesUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"cmbDia","Dia","","","alpha_spaces_enie fecha adicional incompleto","validarCamposAdicional","true","Año",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbAño","divInputAreaAño","Año","Año","4",0,"divAño","AñoUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"cmbDia","Dia","","","numbers fecha adicional incompleto","validarCamposAdicional","false","Mes",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable));jsonComboAutocompletable=$.extend(cargarValoresPrimariosAutocomplete("cmbEstadoCivilAdicional","divInputAreaEstadoCivilAdicional","EstadoCivilAdicional","Estado Civil","25",0,"divEstadoCivilAdicional","EstadoCivilAdicionalUl","autocompleteClass"),cargarValoresSecundariosAutocomplete(!1,"","",!1,"","alpha_spaces_enie incompleto adicional","validarCamposAdicional","","",!1,""));crearComboboxAutocompletable(JSON.stringify(jsonComboAutocompletable))}function limpiarCPOtraDireccion(){var n=$("#OtraDireccionCodigoPostal"),t;n.val("").blur();t=n.parent();t.removeClass().addClass("inputArea")}function limpiarCPTitular(){var n=$("#CodigoPostal"),t;n.val("").blur();t=n.parent();t.removeClass().addClass("inputArea")}function cargarEventosInputAdicionales(){$("#cmbOcaLoc").click(function(){if($("#listaOCALoc").children("li").size()===0)return!1});$("#Dia,#Mes,#Año,#EstadoCivilAdicional,#NacionalidadAdicional,#PaisNacimientoAdicional").blur(function(){$this=$("#"+$(this).attr("id")+"Sel");$this.val($("#cmb"+$(this).attr("id")).val());$this.focus();$this.blur()});$("#cmbOCAfechas").click(function(){if($("#listaFechasEntrega").children("li").size()===0)return!1});$("#listaOCALoc").children().click(function(){activeTwo();agregarEventosSeleccionOpcionListaDesplegable($(this).children(),"txtOcaLoc","LocalidadOCA");$("#cmbOCAfechas").text("Fecha de Entrega");$("#fechaOCAsel").val("");$("#fechaOCAsel").blur();buscarTurnosAjax($(this).children().data("value"))})}function validarCamposPrimeraParte(){if($("#DivDatosTitular .incompleto").size()===0){if($("#ViviendaDpto").is(":checked")){if($("#Piso").val()&&!validateRegEx($("#Piso").val(),regEx_alphanumeric)){showErrorModal("Mensaje",$("#Piso").attr("errmsg"));return}if($("#Departamento").val()&&!validateRegEx($("#Departamento").val(),regEx_alphanumeric)){showErrorModal("Mensaje",$("#Departamento").attr("errmsg"));return}}if($("#cmbResidenciaTributaria").val()!=="080"){validoPrimeraParte=!1;validarSecciones();return}if(CpValidado!==!0){validoPrimeraParte=!1;return}validoPrimeraParte=!0;LLenarJsonModificarCliente();modificarCliente(jsonModifCliente)}else{if($("#ProvinciaTitular").val()===""||$("#LocalidadTitular").val()===""){$("#txtOcaLoc").text("Localidad");$("#LocalidadOCA").val("");$("#LocalidadOCA").blur();$("#fechaEntrega").text("Fecha de Entrega");$("#fechaOCAsel").val("");$("#fechaOCAsel").blur();validoPrimeraParte=!1;return}validoPrimeraParte=!1;validarSecciones()}}function LLenarJsonModificarCliente(){jsonModifCliente={Domicilio:{CodigoProvincia:$("#cmbProvinciaTitular").val(),CodigoLocalidad:$("#cmbLocalidadTitular").val(),NombreCalle:$("#NombreCalle").val(),Altura:$("#NumeroCalle").val(),CodigoPostal:$("#CodigoPostal").val(),Piso:$("#Piso").val(),Departamento:$("#Departamento").val()},TributarioEnExterior:"NO",CodigoEstadoCivil:$("#cmbEstadoCivilTitular").val(),CodigoNacionalidad:$("#cmbNacionalidadTitular").val(),CodigoPaisNacimiento:$("#cmbPaisNacimientoTitular").val()};jsonModifCliente=JSON.stringify(jsonModifCliente)}function LLenarJsonLocalidadesOca(){jsonAjaxLoc={NombreCalle:$("#OtraDireccionNombreCalle").val(),Altura:$("#OtraDireccionNumeroCalle").val(),CodigoPostal:$("#OtraDireccionCodigoPostal").val(),Piso:$("#OtraDireccionPiso").val(),Departamento:$("#OtraDireccionDepartamento").val(),CodigoProvincia:$("#cmbProvincia").val(),NombreLocalidad:$("#Localidad").val()};jsonAjaxLoc=JSON.stringify(jsonAjaxLoc)}function validarCamposSegundaParte(){if(envioOtraDireccion&&ValidarCodigoPostalOtroDomicilio&&$("#otraDireccion .incompleto").size()===0){if($("#OtraDireccionViviendaDepartamento").is(":checked")){if($("#OtraDireccionPiso").val()&&!validateRegEx($("#OtraDireccionPiso").val(),regEx_alphanumeric)){showErrorModal("Mensaje",$("#OtraDireccionPiso").attr("errmsg"));return}if($("#OtraDireccionDepartamento").val()&&!validateRegEx($("#OtraDireccionDepartamento").val(),regEx_alphanumeric)){showErrorModal("Mensaje",$("#OtraDireccionDepartamento").attr("errmsg"));return}}validoSegundaParte=!0;LLenarJsonLocalidadesOca();ajaxBuscarLocalidadesOCA(jsonAjaxLoc)}else validoSegundaParte=!1;validarSecciones()}function validarCamposTerceraParte(){$("#divEnvioProd .incompleto").size()===0?altaPrepacto($("#fechaOCAsel").val(),$("#fechaOCAsel").data("special")):(validaTercerParte=!1,validarSecciones())}function habilitarBotonContinuar(){$(".incompleto").size()===0&&($("#btn-Continuar").removeClass("btn btn-md disabled margin-bottom-60 margin-top-60"),$("#btn-Continuar").addClass("btn btn-md margin-bottom-60 margin-top-60"))}function validarCPDomicilioTitular(n,t,i){$("#combos-fecha-entrega").show();$("#mensaje-fecha-entrega").hide();validaTercerParte=!1;CpValidado=!1;var r=$("#CodigoPostal");$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/ValidarCpDomicilio",data:{codProv:n,codLoc:t,codPostal:i},success:function(n){IsAjaxError(n)?(showErrorModal("Error","El Código Postal ingresado no coincide con tu Localidad."),r.val(""),r.parent().attr("class","inputArea"),r.blur()):n?($("#txtOcaLoc").text("Localidad"),$("#LocalidadOCA").val(""),$("#LocalidadOCA").blur(),$("#fechaEntrega").text("Fecha de Entrega"),$("#fechaOCAsel").val(""),$("#fechaOCAsel").blur(),CpValidado=!0,validarCamposPrimeraParte()):(showErrorModal("Error","El Código Postal ingresado no coincide con tu Localidad."),r.val(""),r.parent().attr("class","inputArea"),r.blur())}})}function modificarCliente(n){$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/ModificarCliente",data:{jsonModifCliente:n},success:function(n){IsAjaxError(n)||(activeTwo(),validoSegundaParte=!0,$("#ViviendaCasa").is(":checked")?$("#DireccionTitular").html(MensajeDireccion+$("#NombreCalle").val()+" "+$("#NumeroCalle").val()):$("#DireccionTitular").html(MensajeDireccion+$("#NombreCalle").val()+" "+$("#NumeroCalle").val()+($("#Piso").val()?" Piso "+$("#Piso").val():"")+($("#Departamento").val()?" Departamento "+$("#Departamento").val():"")),validarSecciones(),$("#p-direccion").hasClass("active")&&ajaxBuscarLocalidadesOCA("EsDomicilioPersonal"),$("#SucursalProvincia").val()===""&&actualizarSeccionSucursales(),iniciarMapa())}})}function ajaxBuscarLocalidadesOCA(n){PrepactoImposible||$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/BuscarLocalidadesOca",data:{jsonAjaxLoc:n},success:function(n){IsAjaxError(n)?prepactoImposible():(buscoLocalidadesOCA=!0,$("#txtOcaLoc").text("Localidad"),$("#LocalidadOCA").val(""),$("#LocalidadOCA").addClass("incompleto"),$("#fechaEntrega").text("Fecha de Entrega"),$("#fechaOCAsel").val(""),$("#fechaOCAsel").addClass("incompleto"),$("#listaOCALoc").empty(),validarCamposTerceraParte(),$.each(n.localidades,function(){$("#listaOCALoc").append($("<li><a href='javascript:void(0)' class='opcionOCAloc'  data-value='"+this.Id+"'>"+this.Descripcion+"<\/a><\/li>"))}),$("#listaOCALoc").children().click(function(){activeThree();agregarEventosSeleccionOpcionListaDesplegable($(this).children(),"txtOcaLoc","LocalidadOCA");buscarTurnosAjax($(this).children().data("value"))}))}})}function buscarTurnosAjax(n){$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/ObtenerTurnos",data:{cod:n},success:function(n){IsAjaxError(n)?prepactoImposible():($("#listaFechasEntrega").empty(),$.each(n.turnos,function(){var n=this.FechaTurno.substring(this.FechaTurno.indexOf("(")+1,this.FechaTurno.indexOf(")"));n=new Date(parseInt(n));var t=n.getMonth()+1,i=n.getDate(),r=n.getFullYear(),u=n.getHours(),f=n.getMinutes(),e=n.getSeconds(),o=i+"/"+t+"/"+r+" "+u+":"+f+":"+e,s=i+"/"+t,h=this.HoraDesde.split(":"),c=this.HoraHasta.split(":");$("#listaFechasEntrega").append($('<li><a href="javascript:void(0)" data-special= "'+o+'" data-value="'+this.IdTurno+'">'+this.DiaTurno+" "+s+" de "+h[0]+" a "+c[0]+"hs<\/a><\/li>"))}),$("#listaFechasEntrega").children().click(function(){agregarEventosSeleccionOpcionListaDesplegable($(this).children(),"fechaEntrega","fechaOCAsel")}))}})}function altaPrepacto(n,t){$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/CrearPrepacto",data:{idTurno:n,fechaTurno:t},success:function(n){IsAjaxError(n)?prepactoImposible():validaTercerParte=!0;validarSecciones()}})}function prepactoImposible(){$("#combos-fecha-entrega").hide();$("#mensaje-fecha-entrega").show().children().children().html("Recibir&aacute;s la tarjeta en tu domicilio a partir de los "+cantDiasPrepac+" días h&aacute;biles.");PrepactoImposible=!0;validaTercerParte=!0}function LLenarJsonAdicional(n){var t=new Date($("#Año").val(),parseInt($("#cmbMes").val()-1),$("#Dia").val());JsonAdicionales={Adicional:{CodigoEstadoCivil:$("#cmbEstadoCivilAdicional").val(),CodigoNacionalidad:$("#cmbNacionalidadAdicional").val(),CodigoPaisNacimiento:$("#cmbPaisNacimientoAdicional").val(),DocumentNumber:$("#DocumentoAdicional").val(),FechaNacimiento:t,Gender:$("input[name='SexoAdicional']:checked").val(),Email:$("#EmailAdicional").val(),FirstName:$("#NombreAdicional").val(),LastName:$("#ApellidoAdicional").val()},Indices:n};JsonAdicionales=JSON.stringify(JsonAdicionales)}function mostrarErrorAdicional(n,t,i){switchModalError(n);$("#modal-error-adicional").hasClass("in")||$("#modal-error-adicional").modal("show");$("#btn-modal-error-adicional").html(i);$("#btn-modal-error-adicional").unbind("click");$("#btn-ErrorCerrar").click(function(){$("div[name = ModalAdicional]").modal("hide");switchModalAdicional();t&&vaciarValoresAdicional()});$("#btn-modal-error-adicional").click(function(){t&&($("div[name = ModalAdicional]").modal("hide"),vaciarValoresAdicional());switchModalAdicional()});$("#ModalErrorAdicional").show()}function switchModalError(n){$("#ContenidoModalAdicional").hide();$("div[name = ModalAdicional]").attr("id","modal-error-adicional");$("#MensajeErrorAdicional").html(n)}function switchModalAdicional(){$("#ModalErrorAdicional").hide();$("div[name = ModalAdicional]").attr("id","modalAdicionalPaquete");$("#ContenidoModalAdicional").show()}function validarAdicional(n){if(!validarFecha($("#Dia").val(),parseInt($("#cmbMes").val())-1,$("#Año").val(),parseInt(añoMinimoAdicional),parseInt(añoMaximoAdicional))){mostrarErrorAdicional("Para poder solicitar una tarjeta de crédito tenés que ser mayor de "+añoMinimoAdicional+" años y menor de "+añoMaximoAdicional+" años.<br>",!1,"Aceptar");return}if($("#EmailAdicional").val()&&!validateRegEx($("#EmailAdicional").val(),regEx_mail)){mostrarErrorAdicional($("#EmailAdicional").attr("errmsg"),!1,"Aceptar");return}var t=[];n?$("input[type=checkbox][name=checkMarca]:checked").each(function(){t=t.concat(parseInt($(this).attr("value")))}):t=t.concat(0);LLenarJsonAdicional(t);altaAdicional()}function altaAdicional(){if(stopDoubleSubmit("btnAdicional"),$("#btnAdicional").data("value")==="esModificar"){modificarAdicional();return}$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/ValidarAdicional",data:{jsonAltaAdicional:JsonAdicionales},success:function(n){var r,i,t;if(IsAjaxError(n))mostrarErrorAdicional("Datos del adicional incorrectos, revise la información ingresada.",!1,"Aceptar");else{if(!n.resultado&&n.codigoResultado!==undefined){r=obtenerMensajeErrorSegunCodigoResultado(n.codigoResultado);mostrarErrorAdicional(r,!0,"Aceptar");return}for(i=[],t=0;t<n.Marcas.length;t++)i[t]="icon-"+n.Marcas[t].toLowerCase(),marcasAdicionales[t].Cantidad++,agregarAdicionalSeccionDerecha(n.Marcas[t],marcasAdicionales[t].Cantidad);agregarMiniaturaAdicional(i);$("#modalAdicionalPaquete").modal("hide");vaciarValoresAdicional()}}})}function obtenerMensajeErrorSegunCodigoResultado(n){switch(n){case"MaxAlcanzados":return"Ya alcanzaste el número máximo de adicionales para sumar.";case"PersonaAdicionalInvalida":return"Ingresá un nuevo adicional o modificá sus datos si ya existe.";default:return"Datos del adicional incorrectos, revise la información ingresada."}}function modificarAdicional(){var r=$("#EmailAdicional").val(),u=$("#cmbEstadoCivilAdicional").val(),i=$("#DocumentoAdicional").val(),n=[],t;$("input[name=checkMarca]").each(function(t){n[t]=$(this).is(":checked")?$(this).data("value"):null});t={Email:r,CodigoEstadoCivil:u,DocumentNumber:i,Marcas:n};t=JSON.stringify(t);$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/ModificarAdicional",data:{jsonModificarAdicional:t},success:function(t){if(!IsAjaxError(t)){if(n.length>0){var r="";$("[id^="+$("#DocumentoAdicional").val().trim()+"-right]").each(function(){$(this).remove()});$("input[name=checkMarca]").each(function(){$(this).is(":checked")&&(r+="<p class='icon-"+$(this).data("value").toLowerCase()+"'><\/p>",modificarAdicionalSeccionDerecha($(this).data("value").toLowerCase()))});actualizarCantidadAdicionales();$("#"+i+"-Marcas").empty().append(r)}return $("div[name = ModalAdicional]").modal("hide"),vaciarValoresAdicional(),!0}}})}function eliminarAdicional(n){mostrarErrorAdicional("Vas a eliminar un adicional. ¿Estás seguro?",!1,"Eliminar");$("#btn-modal-error-adicional").unbind("click");$("#btn-modal-error-adicional").click(function(){$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/BajaAdicional",data:{du:n},success:function(t){IsAjaxError(t)?mostrarErrorAdicional("No fue posible eliminar la tarjeta",!0,"Aceptar"):($("div[name="+n+"]").remove(),$("div[name = ModalAdicional]").modal("hide"),actualizarCantidadAdicionales(),vaciarValoresAdicional(),switchModalAdicional())}})})}function actualizarCantidadAdicionales(){for(var n=0;n<marcasAdicionales.length;n++)marcasAdicionales[n].Cantidad=$("#Adicionales-"+marcasAdicionales[n].NombreMarca).find(".adicionalContable").length,marcasAdicionales[n].Cantidad===0?$("#Adicionales-"+marcasAdicionales[n].NombreMarca).hide():$(".icon-"+marcasAdicionales[n].NombreMarca.toLowerCase()+"-white").is(":visible")||$(".icon-"+marcasAdicionales[n].NombreMarca.toLowerCase()+"-white:first").show()}function modificarAdicionalSeccionDerecha(n){var r=$("#NombreAdicional").val().trim()+" "+$("#ApellidoAdicional").val().trim(),i,t;for(r=capitalizarNombre(r),i="<div name='"+$("#DocumentoAdicional").val().trim()+"' id='"+$("#DocumentoAdicional").val().trim()+"-right' class='adicionalContable row'>",t=0;t<marcasAdicionales.length;t++)marcasAdicionales[t].NombreMarca.toLowerCase()===n.toLowerCase()&&(i+=marcasAdicionales[t].Cantidad===1?'<div class="col-xs-2 col-sm-3 col-md-3 col-lg-3"><div class="icon-'+n.toLowerCase()+'-white"><\/div><\/div>':'<div class="col-xs-2 col-sm-3 col-md-3 col-lg-3"><div style="display:none" class="icon-'+n.toLowerCase()+'-white"><\/div><\/div>',i+='<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7"><h3 id="nombre" >'+r+'<\/h3><\/div><div class="col-xs-2"> <a href="javascript:void(0);" id="modif-right-'+$("#DocumentoAdicional").val().trim()+'" data-target="#modalAdicionalPaquete" onclick="recargarDatos(\''+$("#DocumentoAdicional").val().trim()+'\')"><i class="fa fa-pencil" aria-hidden="true"><\/i><\/a><\/div><\/div>');$("#Adicionales-"+n.toUpperCase()).append(i);$("#Adicionales-"+n.toUpperCase()).show()}function recargarDatos(n){$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/BuscarAdicional",data:{nrodoc:n},success:function(n){var t,e,r;if(IsAjaxError(n))showErrorModal("Mensaje","No es posible modificar su adicional");else{t=n.Adicional.FechaNacimiento.substring(n.Adicional.FechaNacimiento.indexOf("(")+1,n.Adicional.FechaNacimiento.indexOf(")"));t=new Date(parseInt(t));var u=t.getFullYear(),f=t.getMonth()+1,i=t.getDate();for(i.toString().length===1&&(i="0"+i),e=n.Adicional.Gender.toString()==="1"?"sexoF":"sexoM",$("#cmbPaisNacimientoAdicional").val(n.Adicional.CodigoPaisNacimiento),$("#cmbNacionalidadAdicional").val(n.Adicional.CodigoNacionalidad),$("#cmbEstadoCivilAdicional").val(n.Adicional.CodigoEstadoCivil),$("#EstadoCivilAdicional").val($("#cmbEstadoCivilAdicional").find("[value='"+n.Adicional.CodigoEstadoCivil+"']").html()).prop("disabled",!0),$("#NacionalidadAdicional").val($("#ListaNacionalidadAdicionalFull").children().find("[data-value='"+n.Adicional.CodigoNacionalidad+"']").html()).prop("disabled",!0),$("#PaisNacimientoAdicional").val($("#ListaPaisNacimientoAdicionalFull").children().find("[data-value='"+n.Adicional.CodigoPaisNacimiento+"']").html()).prop("disabled",!0),$("#DocumentoAdicional").val(n.Adicional.DocumentNumber).prop("disabled",!0),$("#DocumentoAdicional").parent().removeClass().addClass("inputArea typed"),$("#Dia").val(i).prop("disabled",!0),$("#Mes").val($("#cmbMes").find("[value='"+f+"']").html()).prop("disabled",!0),$("#Año").val(u).prop("disabled",!0),$("#cmbAño").val(u),$("#cmbMes").val(f),$("#cmbDia").val(i),$("#"+e).prop("checked",!0),$("input[name=SexoAdicional]").prop("disabled",!0).next().addClass("disabled"),$(".adicional").removeClass("incompleto"),n.Adicional.Email!==""&&$("#EmailAdicional").val(n.Adicional.Email),$("#NombreAdicional").val(n.Adicional.FirstName).prop("disabled",!0),$("#ApellidoAdicional").val(n.Adicional.LastName).prop("disabled",!0),$("#btnAdicional").data("value","esModificar").prop("disabled",!1).removeClass("disabled"),$("input[name=checkMarca]").prop("checked",!1),r=0;r<n.Marcas.length;r++)$("input[name=checkMarca][data-value="+n.Marcas[r]+"]").prop("checked",!0).removeClass("incompleto");$("#AdicionalModal :input").focus().blur();$("#AdicionalModal input[type=text]").blur();$("#modalAdicionalPaquete").modal("show")}}})}function capitalizarNombre(n){return n.toLowerCase().replace(/\b[a-z]/g,function(n){return n.toUpperCase()})}function agregarAdicionalSeccionDerecha(n,t){var r=$("#NombreAdicional").val().trim()+" "+$("#ApellidoAdicional").val().trim(),i;r=capitalizarNombre(r);i='   <div name="'+$("#DocumentoAdicional").val().trim()+'" class="row adicionalContable" id="'+$("#DocumentoAdicional").val().trim()+'-right">';i=t===1?i+'<div class="col-xs-2 col-sm-3 col-md-3 col-lg-3"><div class="icon-'+n.toLowerCase()+'-white"><\/div><\/div>':i+'<div class="col-xs-2 col-sm-3 col-md-3 col-lg-3"><div style="display:none" class="icon-'+n.toLowerCase()+'-white"><\/div><\/div>';i=i+'<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7"><h3 id="nombre" >'+r+'<\/h3><\/div><div class="col-xs-2"> <a href="javascript:void(0);" id="modif-right-'+$("#DocumentoAdicional").val().trim()+'" data-target="#modalAdicionalPaquete" onclick="recargarDatos(\''+$("#DocumentoAdicional").val().trim()+'\')"><i class="fa fa-pencil" aria-hidden="true"><\/i><\/a><\/div><\/div>';$("#Adicionales-"+n.toUpperCase()).append(i);$("#Adicionales-"+n.toUpperCase()).show()}function agregarMiniaturaAdicional(n){var i=$("#NombreAdicional").val().trim()+" "+$("#ApellidoAdicional").val().trim(),r,t,u;for(i=capitalizarNombre(i),r="",t=0;t<n.length;t++)r+="<p class='"+n[t]+"'><\/p>";u='<div class="col-xs-12 col-sm-3 col-md-3 col-lg-3 miniatura" name="'+$("#DocumentoAdicional").val().trim()+'"><div class="client"><div class="row"><div class="col-xs-6"><div id="'+$("#DocumentoAdicional").val().trim()+'-Marcas" class="icons-cards">'+r+'<\/div><\/div><div class="col-xs-6"><div class="edit-delete"><a href="javascript:void(0)" id="modif" data-target="#modalAdicionalPaquete" onclick="recargarDatos(\''+$("#DocumentoAdicional").val().trim()+'\')"><i class="fa fa-pencil" aria-hidden="true"><\/i><\/a> <a href="javascript:void(0)" id="borrar" onclick="eliminarAdicional(\''+$("#DocumentoAdicional").val().trim()+'\')"><i class="fa fa-trash-o" aria-hidden="true"><\/i><\/a><\/div><\/div><\/div><div class="row"><div class="col-xs-12"><h5>Adicional asignada a<\/h5><h4 id="nombre">'+i+"<\/h4><\/div><\/div><\/div><\/div>";$("#adiMiniatura").append(u)}function validarCamposAdicional(){$("#AdicionalModal .incompleto").size()===0?$("#btnAdicional").hasClass("disabled")&&($("#btnAdicional").removeClass("disabled"),$("#btnAdicional").prop("disabled",!1)):($("#btnAdicional").addClass("disabled"),$("#btnAdicional").prop("disabled",!0))}function vaciarValoresAdicional(){$("input[name=SexoAdicional]").prop("disabled",!1).attr("checked",!1).next().removeClass("disabled");$("input[name=checkMarca]").each(function(){this.checked=!0});$("#EmailAdicional").val("");$(".adicional").val("").parent().removeClass("typed focus");$(".adicional").data("value","");$(".adicional").prop("disabled",!1);$("#AdicionalModal input[type=text],#AdicionalModal input[type=tel]").focus();$("#AdicionalModal input[type=text],#AdicionalModal input[type=tel]").blur();$(".adicional").addClass("incompleto");$("#sexoM").val("2");$("#sexoF").val("1");$("#btnAdicional").data("value","")}function showOrHidePisoDpto(n,t,i){n==="ViviendaCasa"?($("#"+t).hide(),$("#"+i).hide()):($("#"+t).show(),$("#"+i).show())}function activeOne(){$("#number-one").removeClass("desactive").addClass("active");$("#number-two").removeClass("active");$("#number-three").removeClass("active");$("#number-four").removeClass("active")}function activeTwo(){$("#number-one").removeClass("active");$("#otraDireccion").is(":visible")?$("#number-two").removeClass("desactive").addClass("column-titles active second long2"):$("#number-two").removeClass("desactive").addClass("column-titles active second long");$("#number-three").removeClass("active");$("#number-four").removeClass("active")}function activeThree(){$("#number-one").removeClass("active");$("#number-two").removeClass("active");$("#number-three").removeClass("desactive").addClass("active");$("#number-four").removeClass("active")}function activeFour(){$("#number-one").removeClass("active");$("#number-two").removeClass("active");$("#number-three").removeClass("active");$("#number-four").removeClass("desactive").addClass("active")}function mostrarDireccion(){validoSegundaParte=!0;validarSecciones();$("#direccion").is(":visible")||($("#otraDireccion").hide(),$("#direccion").show(),$("#p-direccion").removeClass().addClass("active"),$("#p-otraDireccion").removeClass(),$("#number-two").removeClass().addClass("column-titles second long"),envioOtraDireccion=!1,envioMiDomicilio=!0,envioSucursal=!1)}function mostrarOtraDireccion(){validarCamposSegundaParte();var n=$("#otraDireccion");n.is(":visible")||(n.show(),$("#direccion").hide(),$("#p-otraDireccion").removeClass().addClass("active"),$("#p-direccion").removeClass(),$("#number-two").removeClass().addClass("column-titles second long2"),envioOtraDireccion=!0,envioMiDomicilio=!1,envioSucursal=!1)}function mostrarInfoTarjeta(){var n=$("#info-card");if(!n.is(":visible")){n.hide();return}n.show()}function guardarSucursal(n){$.ajax({datatype:"json",type:"POST",url:"/IngresoDatosAdicional/GuardarSucursal",data:{nroSucursal:n},success:function(n){IsAjaxError(n)||validarSecciones()}})}function validarSecciones(){validoPrimeraParte&&validoSegundaParte&&validaTercerParte&&validarComboSucursal?habilitarBoton():deshabilitarBoton()}function habilitarBoton(){$("#btn-Continuar").attr("class","btn btn-md margin-bottom-60 margin-top-60");$("#btn-Continuar").prop("disabled",!1)}function deshabilitarBoton(){$("#btn-Continuar").attr("class","btn btn-md disabled margin-bottom-60 margin-top-60");$("#btn-Continuar").prop("disabled",!0)}var MensajeDireccion="La direcci&oacute;n de tu domicilio es: ",envioOtraDireccion=!1,envioMiDomicilio=!1,envioSucursal=!1,ValidarCodigoPostalOtroDomicilio=!1,CpValidado=!1,validoPrimeraParte=!1,validoSegundaParte=!1,validaTercerParte=!1,validarComboSucursal=!1,PrepactoImposible=!1,cantDiasPrepac,jsonAjaxLoc,jsonModifCliente,JsonAdicionales,jsonComboAutocompletable,marcasAdicionales=[],buscoLocalidadesOCA=!1,añoMaximoAdicional,añoMinimoAdicional,inputAutocomplete,scrollTopAnterior,sucLatlng,marker,$this